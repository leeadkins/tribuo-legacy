<% content_for :sidebar do %>
	<p>
		Currently <%= Family.count %> families in Tribuo.
	</p>
	<p>
		On the Families page, you can see all
		the families you've entered into Tribuo, along
		with some basic information about each one.
		To see more detailed information, or to perform
		changes, click a family.
	</p>
	<p>
		If a family is highlighted in red, the number of 
		children declared doesn't match the number of children
		actually entered and needs to be reviewed.
	</p>
<% end %>

<p>Search (via Last Name for now):
	<% form_tag families_path, :method => 'get' do %>
	  <%= text_field_tag :search, params[:search] %>
	  <%= select_tag :searchfield, options_for_select({'Last Name' => 'lastname', 'First Name' => 'firstname'}, 'lastname')%>
	  <%= submit_tag "Search", :name => nil %>
	<% end %>	
	<%= link_to "Reset", :controller => "families" %>
</p>
<table>
  <tr>
    <th><%= link_to "Last Name", :controller => "families", :order => "lastname", :search => params[:search], :page => params[:page] %></th>
    <th><%= link_to "First Name", :controller => "families", :order => "firstname", :search => params[:search], :page => params[:page] %></th>
    <th><%= link_to "Phone", :controller => "families", :order => "phone", :search => params[:search] %></th>
    <th><%= link_to "Size", :controller => "families", :order => "familysize", :search => params[:search] %></th>
    <th><%= link_to "Children", :controller => "families", :order => "childrensize", :search => params[:search] %></th>
    <th><%= link_to "Food Only?", :controller => "families", :order => "foodonly", :search => params[:search] %></th>
    <th><%= link_to "Box", :controller => "families", :order => "box", :search => params[:search] %></th>
  </tr>

<% for family in @families %>
<% if family.childrensize != family.children_count
		familyliststyle="family-row-error"
	else
		familyliststyle="family-row"
	end
	
%>
  <tr class="<%= familyliststyle %>">
    <td><%=h family.lastname %></td>
    <td><%=h family.firstname %></td>
    <td><%=h family.phone %></td>
    <td><%=h family.familysize %></td>
    <td><%=h family.childrensize %></td>
    <td><%=h family.human_foodonly %></td>
    <td><%=h family.box %></td>
    <td><%= link_to 'Show', family %></td>
    <td><%= link_to 'Edit', edit_family_path(family) %></td>
	<td><%= link_to 'Delete', family, :confirm => "Are you sure?", :method => "delete" %>
  </tr>
<% end %>
</table>

<br />
<%= will_paginate @families %>

<%= link_to 'New family', new_family_path %>
